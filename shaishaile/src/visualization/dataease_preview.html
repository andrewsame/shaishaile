æ³¨æ„922è¡Œï¼Œé‚£é‡Œåç»­éœ€è¦æ”¹åŠ¨ï¼Œå½“æœ‰å®é™…æ•°æ®æ—¶ï¼Œåº”è¯¥å¯ç”¨922çš„ä»£ç 

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenDiggeræ•°æ®åˆ†æå¹³å° - DataEaseé¢„è§ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        
        .header {
            background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);
            color: white;
            padding: 20px 40px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .header .subtitle {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .search-box {
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        .search-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 16px;
            color: #262626;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .search-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #595959;
        }
        
        .form-group select,
        .form-group input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.3s;
            background-color: white;
        }
        
        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.1);
        }
        
        .quick-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }
        
        .quick-btn {
            background: #fafafa;
            border: 1px solid #d9d9d9;
            color: #595959;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .quick-btn:hover {
            background: #1890ff;
            color: white;
            border-color: #1890ff;
        }
        
        .search-buttons {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }
        
        .search-btn {
            background: #1890ff;
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .search-btn:hover {
            background: #0050b3;
        }
        
        .search-btn.secondary {
            background: #fafafa;
            color: #595959;
            border: 1px solid #d9d9d9;
        }
        
        .search-btn.secondary:hover {
            background: #f0f0f0;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .metric-cards {
            grid-column: span 12;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }
        
        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            transition: transform 0.3s;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
        }
        
        .metric-icon {
            font-size: 32px;
            margin-right: 16px;
        }
        
        .metric-content {
            flex: 1;
        }
        
        .metric-name {
            color: #595959;
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: 600;
            color: #1890ff;
        }
        
        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        .chart-container.full {
            grid-column: span 12;
        }
        
        .chart-container.half {
            grid-column: span 6;
        }
        
        .chart-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 16px;
            color: #262626;
        }
        
        .chart-placeholder {
            height: 300px;
            background: #fafafa;
            border: 2px dashed #d9d9d9;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #8c8c8c;
            font-size: 14px;
        }
        
        .data-table {
            grid-column: span 12;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        .table-header {
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .table-content {
            padding: 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: #fafafa;
            padding: 12px 16px;
            text-align: left;
            font-weight: 500;
            color: #262626;
            border-bottom: 1px solid #f0f0f0;
        }
        
        td {
            padding: 12px 16px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        tr:hover {
            background: #fafafa;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: #1890ff;
        }
        
        .loading.active {
            display: block;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #8c8c8c;
            font-size: 12px;
            margin-top: 40px;
            border-top: 1px solid #f0f0f0;
        }
        
        .search-type {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            padding: 12px;
            background: #fafafa;
            border-radius: 6px;
        }
        
        .search-type-btn {
            background: none;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            color: #595959;
            transition: all 0.3s;
        }
        
        .search-type-btn.active {
            background: white;
            color: #1890ff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        @media (max-width: 1200px) {
            .metric-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .chart-container.half {
                grid-column: span 12;
            }
        }
        
        @media (max-width: 768px) {
            .metric-cards {
                grid-template-columns: 1fr;
            }
            
            .search-form {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                flex-direction: column;
            }
            
            .quick-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ OpenDiggeræ•°æ®åˆ†æå¹³å°</h1>
        <div class="subtitle">åŸºäºDataEaseçš„å¯è§†åŒ–åˆ†æå¹³å° - ä¸‹æ‹‰é€‰æ‹©ç‰ˆ</div>
    </div>
    
    <div class="container">
        <!-- æœç´¢åŒºåŸŸ -->
        <div class="search-box">
            <div class="search-title">
                <span>ğŸ” ä»“åº“åˆ†æ</span>
            </div>
            
            <!-- æœç´¢ç±»å‹åˆ‡æ¢ -->
            <div class="search-type" id="searchType">
                <button class="search-type-btn active" onclick="setSearchType('single')">
                    ğŸ“Š å•ä¸ªä»“åº“åˆ†æ
                </button>
                <button class="search-type-btn" onclick="setSearchType('batch')">
                    ğŸ“ˆ æ‰¹é‡ä»“åº“å¯¹æ¯”
                </button>
                <button class="search-type-btn" onclick="setSearchType('trend')">
                    ğŸ“‰ æŒ‡æ ‡è¶‹åŠ¿åˆ†æ
                </button>
            </div>
            
            <!-- å•ä¸ªä»“åº“åˆ†æè¡¨å• -->
            <div id="singleSearch" class="search-form">
                <div class="form-group">
                    <label for="owner">ğŸ‘¤ ä»“åº“æ‰€æœ‰è€…</label>
                    <select id="owner" onchange="updateRepos()">
                        <option value="">è¯·é€‰æ‹©æ‰€æœ‰è€…...</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="repo">ğŸ“ ä»“åº“åç§°</label>
                    <select id="repo">
                        <option value="">è¯·é€‰æ‹©ä»“åº“...</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="language">ğŸ’» ä¸»è¦è¯­è¨€</label>
                    <select id="language" onchange="filterByLanguage()">
                        <option value="">å…¨éƒ¨è¯­è¨€</option>
                        <option value="JavaScript">JavaScript</option>
                        <option value="Python">Python</option>
                        <option value="Java">Java</option>
                        <option value="Go">Go</option>
                        <option value="C++">C++</option>
                        <option value="Rust">Rust</option>
                        <option value="TypeScript">TypeScript</option>
                        <option value="C#">C#</option>
                        <option value="PHP">PHP</option>
                        <option value="Swift">Swift</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="category">ğŸ·ï¸ é¡¹ç›®åˆ†ç±»</label>
                    <select id="category" onchange="filterByCategory()">
                        <option value="">å…¨éƒ¨åˆ†ç±»</option>
                        <option value="web">Webæ¡†æ¶</option>
                        <option value="ai">æœºå™¨å­¦ä¹ /AI</option>
                        <option value="database">æ•°æ®åº“</option>
                        <option value="tools">å¼€å‘å·¥å…·</option>
                        <option value="infra">åŸºç¡€è®¾æ–½</option>
                        <option value="mobile">ç§»åŠ¨å¼€å‘</option>
                        <option value="game">æ¸¸æˆå¼€å‘</option>
                        <option value="security">å®‰å…¨</option>
                        <option value="devops">DevOps</option>
                    </select>
                </div>
            </div>
            
            <!-- å¿«é€Ÿé€‰æ‹©æŒ‰é’® -->
            <div class="quick-actions">
                <div style="font-size: 12px; color: #8c8c8c; margin-right: 8px;">ğŸš€ çƒ­é—¨é¡¹ç›®:</div>
                <button class="quick-btn" onclick="selectRepo('X-lab2018', 'open-digger')">
                    OpenDigger
                </button>
                <button class="quick-btn" onclick="selectRepo('vuejs', 'vue')">
                    Vue.js
                </button>
                <button class="quick-btn" onclick="selectRepo('facebook', 'react')">
                    React
                </button>
                <button class="quick-btn" onclick="selectRepo('tensorflow', 'tensorflow')">
                    TensorFlow
                </button>
                <button class="quick-btn" onclick="selectRepo('microsoft', 'vscode')">
                    VS Code
                </button>
                <button class="quick-btn" onclick="selectRepo('kubernetes', 'kubernetes')">
                    Kubernetes
                </button>
                <button class="quick-btn" onclick="selectRepo('docker', 'docker')">
                    Docker
                </button>
                <button class="quick-btn" onclick="selectRepo('spring-projects', 'spring-boot')">
                    Spring Boot
                </button>
                <button class="quick-btn" onclick="selectRepo('django', 'django')">
                    Django
                </button>
                <button class="quick-btn" onclick="selectRepo('flutter', 'flutter')">
                    Flutter
                </button>
            </div>
            
            <!-- æœç´¢æŒ‰é’® -->
            <div class="search-buttons">
                <button class="search-btn" onclick="analyzeRepository()">
                    <span>ğŸ“Š å¼€å§‹åˆ†æ</span>
                </button>
                <button class="search-btn secondary" onclick="resetSearch()">
                    <span>ğŸ”„ é‡ç½®é€‰æ‹©</span>
                </button>
                <button class="search-btn secondary" onclick="loadSampleData()">
                    <span>ğŸ¯ åŠ è½½ç¤ºä¾‹</span>
                </button>
            </div>
        </div>
        
        <!-- åŠ è½½çŠ¶æ€ -->
        <div class="loading" id="loading">
            <div>æ­£åœ¨è·å–æ•°æ®...</div>
        </div>
        
        <!-- ä»ªè¡¨æ¿åŒºåŸŸ -->
        <div id="dashboard" style="display: none;">
            <!-- æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ -->
            <div class="dashboard-grid">
                <div class="metric-cards" id="metricCards">
                    <!-- æŒ‡æ ‡å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- å›¾è¡¨åŒºåŸŸ -->
            <div class="dashboard-grid">
                <div class="chart-container half">
                    <div class="chart-title">ğŸ“ˆ é¡¹ç›®ç»¼åˆè¯„åˆ†é›·è¾¾å›¾</div>
                    <div class="chart-placeholder">
                        é›·è¾¾å›¾å°†åœ¨è¿™é‡Œæ˜¾ç¤º
                    </div>
                </div>
                
                <div class="chart-container half">
                    <div class="chart-title">ğŸ“Š æ´»è·ƒåº¦è¶‹åŠ¿å›¾</div>
                    <div class="chart-placeholder">
                        è¶‹åŠ¿å›¾å°†åœ¨è¿™é‡Œæ˜¾ç¤º
                    </div>
                </div>
            </div>
            
            <!-- æ•°æ®è¡¨æ ¼ -->
            <div class="dashboard-grid">
                <div class="data-table">
                    <div class="table-header">
                        <div class="chart-title">ğŸ“‹ çƒ­é—¨ä»“åº“å¯¹æ¯”</div>
                    </div>
                    <div class="table-content">
                        <table id="comparisonTable">
                            <thead>
                                <tr>
                                    <th>ä»“åº“åç§°</th>
                                    <th>ä¸»è¦è¯­è¨€</th>
                                    <th>OpenRank</th>
                                    <th>æ´»è·ƒåº¦</th>
                                    <th>è´¡çŒ®è€…æ•°</th>
                                    <th>æäº¤é¢‘ç‡</th>
                                    <th>å“åº”æ—¶é—´(å¤©)</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                                <!-- è¡¨æ ¼æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>OpenDiggeræ•°æ®åˆ†æå¹³å° Â© 2024 | DataEaseå¯è§†åŒ–é¢„è§ˆç‰ˆ</p>
        <p>ä½¿ç”¨ä¸‹æ‹‰èœå•é€‰æ‹©ä»“åº“ï¼Œç‚¹å‡»"å¼€å§‹åˆ†æ"è·å–æ•°æ®</p>
    </div>
    
    <script>
        // ä»“åº“æ•°æ® - ç”¨äºä¸‹æ‹‰èœå•
        const repositoryData = {
            // æŒ‰æ‰€æœ‰è€…åˆ†ç»„
            owners: [
                "X-lab2018", "vuejs", "facebook", "tensorflow", "pytorch",
                "microsoft", "google", "alibaba", "Tencent", "apache",
                "spring-projects", "django", "flask", "nodejs", "docker",
                "kubernetes", "elastic", "mongodb", "redis", "postgres",
                "golang", "rust-lang", "flutter", "electron", "vercel",
                "netflix", "airbnb", "uber", "lyft", "spotify"
            ],
            
            // ä»“åº“åˆ—è¡¨ï¼ˆowner -> [repos]ï¼‰
            reposByOwner: {
                "X-lab2018": ["open-digger", "github-analysis"],
                "vuejs": ["vue", "vuex", "vue-router", "vue-cli"],
                "facebook": ["react", "react-native", "jest", "create-react-app"],
                "tensorflow": ["tensorflow", "tfjs", "tensor2tensor"],
                "pytorch": ["pytorch", "vision", "audio", "text"],
                "microsoft": ["vscode", "TypeScript", "dotnet", "PowerToys"],
                "google": ["angular", "golang", "kubernetes", "material-design"],
                "alibaba": ["arthas", "nacos", "dubbo", "fastjson"],
                "apache": ["kafka", "hadoop", "spark", "flink"],
                "spring-projects": ["spring-boot", "spring-framework", "spring-cloud"],
                "docker": ["docker", "compose", "machine"],
                "kubernetes": ["kubernetes", "minikube", "dashboard"],
                "elastic": ["elasticsearch", "kibana", "logstash", "beats"]
            },
            
            // çƒ­é—¨ä»“åº“ï¼ˆç”¨äºå¿«é€Ÿé€‰æ‹©ï¼‰
            popularRepos: [
                {owner: "X-lab2018", repo: "open-digger", language: "JavaScript", category: "tools"},
                {owner: "vuejs", repo: "vue", language: "JavaScript", category: "web"},
                {owner: "facebook", repo: "react", language: "JavaScript", category: "web"},
                {owner: "tensorflow", repo: "tensorflow", language: "Python", category: "ai"},
                {owner: "pytorch", repo: "pytorch", language: "Python", category: "ai"},
                {owner: "microsoft", repo: "vscode", language: "TypeScript", category: "tools"},
                {owner: "google", repo: "angular", language: "TypeScript", category: "web"},
                {owner: "alibaba", repo: "arthas", language: "Java", category: "tools"},
                {owner: "apache", repo: "kafka", language: "Java", category: "infra"},
                {owner: "spring-projects", repo: "spring-boot", language: "Java", category: "web"},
                {owner: "docker", repo: "docker", language: "Go", category: "infra"},
                {owner: "kubernetes", repo: "kubernetes", language: "Go", category: "infra"},
                {owner: "elastic", repo: "elasticsearch", language: "Java", category: "database"},
                {owner: "mongodb", repo: "mongo", language: "C++", category: "database"},
                {owner: "redis", repo: "redis", language: "C", category: "database"},
                {owner: "postgres", repo: "postgres", language: "C", category: "database"},
                {owner: "flutter", repo: "flutter", language: "Dart", category: "mobile"},
                {owner: "electron", repo: "electron", language: "C++", category: "tools"}
            ],
            
            // è¯­è¨€åˆ†ç±»
            languages: {
                "JavaScript": ["vuejs/vue", "facebook/react", "X-lab2018/open-digger"],
                "Python": ["tensorflow/tensorflow", "pytorch/pytorch", "django/django"],
                "Java": ["spring-projects/spring-boot", "alibaba/arthas", "apache/kafka"],
                "Go": ["docker/docker", "kubernetes/kubernetes", "golang/go"],
                "C++": ["tensorflow/tensorflow", "mongodb/mongo", "electron/electron"],
                "TypeScript": ["microsoft/vscode", "google/angular", "microsoft/TypeScript"],
                "C": ["redis/redis", "postgres/postgres", "git/git"],
                "Rust": ["rust-lang/rust", "denoland/deno", "servo/servo"],
                "C#": ["dotnet/core", "Unity-Technologies/Unity", "microsoft/dotnet"],
                "PHP": ["laravel/laravel", "symfony/symfony", "composer/composer"],
                "Swift": ["apple/swift", "Alamofire/Alamofire", "SwiftUI/SwiftUI"],
                "Dart": ["flutter/flutter", "dart-lang/sdk", "firebase/flutterfire"]
            },
            
            // åˆ†ç±»æ•°æ®
            categories: {
                "web": ["vuejs/vue", "facebook/react", "spring-projects/spring-boot"],
                "ai": ["tensorflow/tensorflow", "pytorch/pytorch", "scikit-learn/scikit-learn"],
                "database": ["elastic/elasticsearch", "mongodb/mongo", "redis/redis"],
                "tools": ["microsoft/vscode", "X-lab2018/open-digger", "docker/docker"],
                "infra": ["kubernetes/kubernetes", "apache/kafka", "istio/istio"],
                "mobile": ["flutter/flutter", "facebook/react-native", "expo/expo"],
                "game": ["Unity-Technologies/Unity", "godotengine/godot", "libgdx/libgdx"],
                "security": ["OWASP/CheatSheetSeries", "hashcat/hashcat", "NationalSecurityAgency/ghidra"],
                "devops": ["jenkinsci/jenkins", "hashicorp/terraform", "ansible/ansible"]
            }
        };
        
        // å½“å‰æœç´¢ç±»å‹
        let currentSearchType = 'single';
        
        // æŒ‡æ ‡å¡ç‰‡é…ç½®
        const metricConfigs = [
            {
                field: 'openrank',
                name: 'OpenRankæŒ‡æ•°',
                icon: 'ğŸ“Š',
                color: '#4CAF50'
            },
            {
                field: 'activity_score',
                name: 'æ´»è·ƒåº¦åˆ†æ•°',
                icon: 'âš¡',
                color: '#2196F3'
            },
            {
                field: 'contributor_count',
                name: 'è´¡çŒ®è€…æ•°é‡',
                icon: 'ğŸ‘¥',
                color: '#FF9800'
            },
            {
                field: 'avg_response_time',
                name: 'å¹³å‡å“åº”å¤©æ•°',
                icon: 'â±ï¸',
                color: '#9C27B0'
            }
        ];
        
        // åˆå§‹åŒ–é¡µé¢
        function initPage() {
            // åˆå§‹åŒ–æ‰€æœ‰è€…ä¸‹æ‹‰èœå•
            initOwnerDropdown();
            
            // é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªæ‰€æœ‰è€…
            if (repositoryData.owners.length > 0) {
                document.getElementById('owner').value = 'X-lab2018';
                updateRepos();
            }
            
            // æ˜¾ç¤ºç¤ºä¾‹æ•°æ®
            loadSampleData();
        }
        
        // åˆå§‹åŒ–æ‰€æœ‰è€…ä¸‹æ‹‰èœå•
        function initOwnerDropdown() {
            const ownerSelect = document.getElementById('owner');
            
            // æ¸…ç©ºç°æœ‰é€‰é¡¹
            ownerSelect.innerHTML = '<option value="">è¯·é€‰æ‹©æ‰€æœ‰è€…...</option>';
            
            // æ·»åŠ æ‰€æœ‰è€…é€‰é¡¹
            repositoryData.owners.forEach(owner => {
                const option = document.createElement('option');
                option.value = owner;
                option.textContent = owner;
                ownerSelect.appendChild(option);
            });
            
            // æ·»åŠ å¸¸ç”¨ç»„ç»‡åˆ†ç»„
            const groups = {
                "å¤§å‹ç§‘æŠ€å…¬å¸": ["microsoft", "google", "facebook", "alibaba", "Tencent", "netflix", "airbnb", "uber", "lyft", "spotify"],
                "å¼€æºåŸºé‡‘ä¼š": ["apache", "linux", "cncf", "openssl", "mozilla"],
                "æµè¡Œæ¡†æ¶": ["vuejs", "angular", "spring-projects", "django", "flask", "laravel", "expressjs"],
                "åŸºç¡€è®¾æ–½": ["docker", "kubernetes", "elastic", "prometheus", "grafana", "jenkinsci", "hashicorp"]
            };
            
            Object.keys(groups).forEach(groupName => {
                const group = document.createElement('optgroup');
                group.label = groupName;
                
                groups[groupName].forEach(owner => {
                    const option = document.createElement('option');
                    option.value = owner;
                    option.textContent = owner;
                    group.appendChild(option);
                });
                
                ownerSelect.appendChild(group);
            });
        }
        
        // æ›´æ–°ä»“åº“ä¸‹æ‹‰èœå•
        function updateRepos() {
            const ownerSelect = document.getElementById('owner');
            const repoSelect = document.getElementById('repo');
            const selectedOwner = ownerSelect.value;
            
            // æ¸…ç©ºç°æœ‰é€‰é¡¹
            repoSelect.innerHTML = '<option value="">è¯·é€‰æ‹©ä»“åº“...</option>';
            
            if (!selectedOwner) return;
            
            // æ·»åŠ è¯¥æ‰€æœ‰è€…çš„ä»“åº“
            if (repositoryData.reposByOwner[selectedOwner]) {
                repositoryData.reposByOwner[selectedOwner].forEach(repo => {
                    const option = document.createElement('option');
                    option.value = repo;
                    option.textContent = repo;
                    repoSelect.appendChild(option);
                });
            }
            
            // æ·»åŠ çƒ­é—¨ä»“åº“ï¼ˆå¦‚æœè¯¥æ‰€æœ‰è€…æœ‰ï¼‰
            repositoryData.popularRepos.forEach(item => {
                if (item.owner === selectedOwner) {
                    const option = document.createElement('option');
                    option.value = item.repo;
                    option.textContent = item.repo;
                    option.dataset.language = item.language;
                    option.dataset.category = item.category;
                    repoSelect.appendChild(option);
                }
            });
        }
        
        // æ ¹æ®è¯­è¨€ç­›é€‰
        function filterByLanguage() {
            const languageSelect = document.getElementById('language');
            const selectedLanguage = languageSelect.value;
            
            if (!selectedLanguage) {
                // é‡ç½®ä¸ºå½“å‰æ‰€æœ‰è€…çš„æ‰€æœ‰ä»“åº“
                updateRepos();
                return;
            }
            
            const ownerSelect = document.getElementById('owner');
            const repoSelect = document.getElementById('repo');
            const selectedOwner = ownerSelect.value;
            
            if (!selectedOwner) {
                alert('è¯·å…ˆé€‰æ‹©æ‰€æœ‰è€…');
                languageSelect.value = '';
                return;
            }
            
            // æ¸…ç©ºç°æœ‰é€‰é¡¹
            repoSelect.innerHTML = '<option value="">è¯·é€‰æ‹©ä»“åº“...</option>';
            
            // ç­›é€‰è¯¥è¯­è¨€ä¸‹çš„ä»“åº“
            const languageRepos = repositoryData.languages[selectedLanguage] || [];
            const filteredRepos = [];
            
            languageRepos.forEach(repoFullName => {
                const [owner, repo] = repoFullName.split('/');
                if (owner === selectedOwner) {
                    filteredRepos.push(repo);
                }
            });
            
            // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œæ˜¾ç¤ºæç¤º
            if (filteredRepos.length === 0) {
                const option = document.createElement('option');
                option.value = '';
                option.textContent = `è¯¥æ‰€æœ‰è€…æ²¡æœ‰${selectedLanguage}é¡¹ç›®`;
                option.disabled = true;
                repoSelect.appendChild(option);
            } else {
                // æ·»åŠ ç­›é€‰åçš„ä»“åº“
                filteredRepos.forEach(repo => {
                    const option = document.createElement('option');
                    option.value = repo;
                    option.textContent = repo;
                    repoSelect.appendChild(option);
                });
            }
        }
        
        // æ ¹æ®åˆ†ç±»ç­›é€‰
        function filterByCategory() {
            const categorySelect = document.getElementById('category');
            const selectedCategory = categorySelect.value;
            
            if (!selectedCategory) {
                updateRepos();
                return;
            }
            
            const ownerSelect = document.getElementById('owner');
            const repoSelect = document.getElementById('repo');
            const selectedOwner = ownerSelect.value;
            
            if (!selectedOwner) {
                alert('è¯·å…ˆé€‰æ‹©æ‰€æœ‰è€…');
                categorySelect.value = '';
                return;
            }
            
            // æ¸…ç©ºç°æœ‰é€‰é¡¹
            repoSelect.innerHTML = '<option value="">è¯·é€‰æ‹©ä»“åº“...</option>';
            
            // ç­›é€‰è¯¥åˆ†ç±»ä¸‹çš„ä»“åº“
            const categoryRepos = repositoryData.categories[selectedCategory] || [];
            const filteredRepos = [];
            
            categoryRepos.forEach(repoFullName => {
                const [owner, repo] = repoFullName.split('/');
                if (owner === selectedOwner) {
                    filteredRepos.push(repo);
                }
            });
            
            // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œæ˜¾ç¤ºæç¤º
            if (filteredRepos.length === 0) {
                const option = document.createElement('option');
                option.value = '';
                option.textContent = 'è¯¥åˆ†ç±»ä¸‹æ²¡æœ‰é¡¹ç›®';
                option.disabled = true;
                repoSelect.appendChild(option);
            } else {
                // æ·»åŠ ç­›é€‰åçš„ä»“åº“
                filteredRepos.forEach(repo => {
                    const option = document.createElement('option');
                    option.value = repo;
                    option.textContent = repo;
                    repoSelect.appendChild(option);
                });
            }
        }
        
        // é€‰æ‹©æŒ‡å®šä»“åº“
        function selectRepo(owner, repo) {
            const ownerSelect = document.getElementById('owner');
            const repoSelect = document.getElementById('repo');
            
            // è®¾ç½®æ‰€æœ‰è€…
            ownerSelect.value = owner;
            
            // æ›´æ–°ä»“åº“åˆ—è¡¨
            updateRepos();
            
            // è®¾ç½®ä»“åº“
            setTimeout(() => {
                repoSelect.value = repo;
            }, 100);
            
            // è§¦å‘åˆ†æ
            setTimeout(() => analyzeRepository(), 200);
        }
        
        // è®¾ç½®æœç´¢ç±»å‹
        function setSearchType(type) {
            currentSearchType = type;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            const buttons = document.querySelectorAll('.search-type-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.includes(getTypeTitle(type))) {
                    btn.classList.add('active');
                }
            });
            
            // æ›´æ–°æœç´¢æ ‡é¢˜
            const title = document.querySelector('.search-title span');
            title.textContent = `ğŸ” ${getTypeTitle(type)}`;
            
            // è¿™é‡Œå¯ä»¥æ ¹æ®ç±»å‹æ˜¾ç¤ºä¸åŒçš„è¡¨å•
            // æš‚æ—¶åªå®ç°å•ä¸ªä»“åº“åˆ†æ
        }
        
        // è·å–ç±»å‹æ ‡é¢˜
        function getTypeTitle(type) {
            const titles = {
                'single': 'å•ä¸ªä»“åº“åˆ†æ',
                'batch': 'æ‰¹é‡ä»“åº“å¯¹æ¯”',
                'trend': 'æŒ‡æ ‡è¶‹åŠ¿åˆ†æ'
            };
            return titles[type] || 'ä»“åº“åˆ†æ';
        }
        
        // åˆ†æä»“åº“
        async function analyzeRepository() {
            const owner = document.getElementById('owner').value;
            const repo = document.getElementById('repo').value;
            
            if (!owner || !repo) {
                alert('è¯·é€‰æ‹©ä»“åº“æ‰€æœ‰è€…å’Œä»“åº“åç§°');
                return;
            }
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('loading').classList.add('active');
            document.getElementById('dashboard').style.display = 'none';
            
            try {
                // åœ¨å®é™…ç¯å¢ƒä¸­ï¼Œè¿™é‡Œåº”è¯¥è°ƒç”¨çœŸå®çš„API
                // const response = await fetch('http://localhost:5000/analyze', {
                //     method: 'POST',
                //     headers: {'Content-Type': 'application/json'},
                //     body: JSON.stringify({ owner, repo })
                // });
                // const data = await response.json();
                
                // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 800));
                
                // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
                const data = {
                    success: true,
                    data: generateSampleData(owner, repo)
                };
                
                if (data.success) {
                    updateDashboard(data.data);
                    loadComparisonData();
                    document.getElementById('dashboard').style.display = 'block';
                    
                    // æ·»åŠ åˆ°å†å²è®°å½•ï¼ˆç®€åŒ–ç‰ˆï¼‰
                    addToHistory(owner, repo);
                } else {
                    alert('è·å–æ•°æ®å¤±è´¥: ' + (data.error || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                alert('è¯·æ±‚å¤±è´¥: ' + error.message);
                // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œæ˜¾ç¤ºæ¨¡æ‹Ÿæ•°æ®
                updateDashboard(generateSampleData(owner, repo));
                loadComparisonData();
                document.getElementById('dashboard').style.display = 'block';
            } finally {
                document.getElementById('loading').classList.remove('active');
            }
        }
        
        // ç”Ÿæˆæ ·æœ¬æ•°æ®
        function generateSampleData(owner, repo) {
            // ä¸ºä¸åŒè¯­è¨€å’Œåˆ†ç±»ç”Ÿæˆä¸åŒçš„æ ·æœ¬æ•°æ®
            const language = document.getElementById('language').value || 'JavaScript';
            const category = document.getElementById('category').value || 'web';
            
            // åŸºç¡€å€¼
            const baseValues = {
                JavaScript: { openrank: 45.2, activity: 8.5, contributors: 128, response: 3.2 },
                Python: { openrank: 87.3, activity: 9.2, contributors: 2894, response: 5.8 },
                Java: { openrank: 65.8, activity: 7.8, contributors: 892, response: 4.5 },
                Go: { openrank: 92.1, activity: 9.5, contributors: 1563, response: 2.4 },
                'C++': { openrank: 76.4, activity: 8.2, contributors: 1123, response: 6.7 },
                TypeScript: { openrank: 81.5, activity: 8.9, contributors: 743, response: 3.8 }
            };
            
            const base = baseValues[language] || baseValues.JavaScript;
            
            // æ ¹æ®åˆ†ç±»è°ƒæ•´
            const categoryMultipliers = {
                web: { openrank: 1.2, activity: 1.1 },
                ai: { openrank: 1.3, activity: 1.2 },
                tools: { openrank: 1.1, activity: 1.0 },
                infra: { openrank: 1.4, activity: 1.3 },
                database: { openrank: 1.5, activity: 1.1 }
            };
            
            const multiplier = categoryMultipliers[category] || { openrank: 1.0, activity: 1.0 };
            
            return {
                repo_name: `${owner}/${repo}`,
                primary_language: language,
                description: `${language} ${category} é¡¹ç›®`,
                openrank: (base.openrank * multiplier.openrank).toFixed(1),
                activity_score: (base.activity * multiplier.activity).toFixed(1),
                contributor_count: base.contributors,
                commit_frequency: (Math.random() * 20 + 5).toFixed(1),
                avg_response_time: base.response.toFixed(1)
            };
        }
        
        // æ›´æ–°ä»ªè¡¨æ¿
        function updateDashboard(repoData) {
            updateMetricCards(repoData);
            updateTableTitle(repoData.repo_name);
            
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            document.title = `OpenDigger - ${repoData.repo_name}`;
        }
        
        // æ›´æ–°æŒ‡æ ‡å¡ç‰‡
        function updateMetricCards(data) {
            const container = document.getElementById('metricCards');
            container.innerHTML = '';
            
            metricConfigs.forEach(config => {
                const value = data[config.field];
                const formattedValue = formatValue(value, config.field);
                
                const card = document.createElement('div');
                card.className = 'metric-card';
                card.innerHTML = `
                    <div class="metric-icon">${config.icon}</div>
                    <div class="metric-content">
                        <div class="metric-name">${config.name}</div>
                        <div class="metric-value" style="color: ${config.color}">${formattedValue}</div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // æ›´æ–°è¡¨æ ¼æ ‡é¢˜
        function updateTableTitle(repoName) {
            const tableHeader = document.querySelector('.table-header .chart-title');
            if (tableHeader) {
                tableHeader.textContent = `ğŸ“‹ ${repoName} ä¸çƒ­é—¨ä»“åº“å¯¹æ¯”`;
            }
        }
        
        // åŠ è½½å¯¹æ¯”æ•°æ®
        function loadComparisonData() {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            // è·å–å½“å‰é€‰æ‹©çš„è¯­è¨€ç”¨äºç­›é€‰å¯¹æ¯”æ•°æ®
            const currentLanguage = document.getElementById('language').value;
            
            // ç­›é€‰å¯¹æ¯”æ•°æ®
            let comparisonRepos = repositoryData.popularRepos;
            if (currentLanguage) {
                comparisonRepos = comparisonRepos.filter(repo => 
                    repo.language === currentLanguage
                );
            }
            
            // é™åˆ¶æ•°é‡
            comparisonRepos = comparisonRepos.slice(0, 8);
            
            comparisonRepos.forEach(item => {
                const row = document.createElement('tr');
                const baseValues = {
                    JavaScript: { openrank: 45.2, activity: 8.5, contributors: 128, response: 3.2 },
                    Python: { openrank: 87.3, activity: 9.2, contributors: 2894, response: 5.8 },
                    Java: { openrank: 65.8, activity: 7.8, contributors: 892, response: 4.5 },
                    Go: { openrank: 92.1, activity: 9.5, contributors: 1563, response: 2.4 },
                    'C++': { openrank: 76.4, activity: 8.2, contributors: 1123, response: 6.7 },
                    TypeScript: { openrank: 81.5, activity: 8.9, contributors: 743, response: 3.8 }
                };
                
                const base = baseValues[item.language] || baseValues.JavaScript;
                
                row.innerHTML = `
                    <td>${item.owner}/${item.repo}</td>
                    <td>${item.language}</td>
                    <td>${base.openrank.toFixed(1)}</td>
                    <td>${base.activity.toFixed(1)}</td>
                    <td>${base.contributors.toLocaleString()}</td>
                    <td>${(Math.random() * 30 + 5).toFixed(1)}</td>
                    <td>${base.response.toFixed(1)}</td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // åŠ è½½ç¤ºä¾‹æ•°æ®
        function loadSampleData() {
            selectRepo('X-lab2018', 'open-digger');
        }
        
        // é‡ç½®æœç´¢
        function resetSearch() {
            document.getElementById('owner').value = '';
            document.getElementById('repo').value = '';
            document.getElementById('language').value = '';
            document.getElementById('category').value = '';
            
            // é‡ç½®ä»“åº“åˆ—è¡¨
            const repoSelect = document.getElementById('repo');
            repoSelect.innerHTML = '<option value="">è¯·é€‰æ‹©ä»“åº“...</option>';
            
            // éšè—ä»ªè¡¨æ¿
            document.getElementById('dashboard').style.display = 'none';
        }
        
        // æ·»åŠ åˆ°å†å²è®°å½•
        function addToHistory(owner, repo) {
            // è¿™é‡Œå¯ä»¥ä¿å­˜åˆ°localStorage
            try {
                const history = JSON.parse(localStorage.getItem('repo_history') || '[]');
                const newItem = { owner, repo, timestamp: new Date().toISOString() };
                
                // ç§»é™¤é‡å¤é¡¹
                const filtered = history.filter(item => 
                    !(item.owner === owner && item.repo === repo)
                );
                
                // æ·»åŠ åˆ°å¼€å¤´ï¼Œæœ€å¤šä¿å­˜10ä¸ª
                filtered.unshift(newItem);
                if (filtered.length > 10) {
                    filtered.pop();
                }
                
                localStorage.setItem('repo_history', JSON.stringify(filtered));
            } catch (e) {
                // å¿½ç•¥localStorageé”™è¯¯
            }
        }
        
        // æ ¼å¼åŒ–æ•°å€¼
        function formatValue(value, field) {
            if (value === undefined || value === null) return '-';
            
            switch(field) {
                case 'openrank':
                case 'activity_score':
                    return parseFloat(value).toFixed(2);
                case 'contributor_count':
                    return parseInt(value).toLocaleString();
                case 'commit_frequency':
                case 'avg_response_time':
                    return parseFloat(value).toFixed(1);
                default:
                    return value;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>