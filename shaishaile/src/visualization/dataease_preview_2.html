ä¸è¦åŠ¨è¿™ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å¤‡ç”¨æ–‡ä»¶ã€‚å¦‚æœä¸»æ–‡ä»¶æ— æ³•ä½¿ç”¨ï¼Œä½¿ç”¨æ­¤æ–‡ä»¶æ¥ä»£æ›¿

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenDiggeræ•°æ®åˆ†æå¹³å° - DataEaseé¢„è§ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        
        .header {
            background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);
            color: white;
            padding: 20px 40px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .header .subtitle {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .search-box {
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        .search-form {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }
        
        .form-group {
            flex: 1;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #595959;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.1);
        }
        
        .search-btn {
            background: #1890ff;
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.3s;
        }
        
        .search-btn:hover {
            background: #0050b3;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .metric-cards {
            grid-column: span 12;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }
        
        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            transition: transform 0.3s;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
        }
        
        .metric-icon {
            font-size: 32px;
            margin-right: 16px;
        }
        
        .metric-content {
            flex: 1;
        }
        
        .metric-name {
            color: #595959;
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: 600;
            color: #1890ff;
        }
        
        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        .chart-container.full {
            grid-column: span 12;
        }
        
        .chart-container.half {
            grid-column: span 6;
        }
        
        .chart-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 16px;
            color: #262626;
        }
        
        .chart-placeholder {
            height: 300px;
            background: #fafafa;
            border: 2px dashed #d9d9d9;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #8c8c8c;
            font-size: 14px;
        }
        
        .data-table {
            grid-column: span 12;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        .table-header {
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .table-content {
            padding: 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: #fafafa;
            padding: 12px 16px;
            text-align: left;
            font-weight: 500;
            color: #262626;
            border-bottom: 1px solid #f0f0f0;
        }
        
        td {
            padding: 12px 16px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        tr:hover {
            background: #fafafa;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: #1890ff;
        }
        
        .loading.active {
            display: block;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #8c8c8c;
            font-size: 12px;
            margin-top: 40px;
            border-top: 1px solid #f0f0f0;
        }
        
        @media (max-width: 1200px) {
            .metric-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .chart-container.half {
                grid-column: span 12;
            }
        }
        
        @media (max-width: 768px) {
            .metric-cards {
                grid-template-columns: 1fr;
            }
            
            .search-form {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ OpenDiggeræ•°æ®åˆ†æå¹³å°</h1>
        <div class="subtitle">åŸºäºDataEaseçš„å¯è§†åŒ–åˆ†æå¹³å° - é¢„è§ˆç‰ˆ</div>
    </div>
    
    <div class="container">
        <!-- æœç´¢åŒºåŸŸ -->
        <div class="search-box">
            <div class="search-form">
                <div class="form-group">
                    <label for="owner">ä»“åº“æ‰€æœ‰è€…</label>
                    <input type="text" id="owner" placeholder="ä¾‹å¦‚ï¼šX-lab2018">
                </div>
                <div class="form-group">
                    <label for="repo">ä»“åº“åç§°</label>
                    <input type="text" id="repo" placeholder="ä¾‹å¦‚ï¼šopen-digger">
                </div>
                <button class="search-btn" onclick="analyzeRepository()">
                    ğŸ“Š å¼€å§‹åˆ†æ
                </button>
            </div>
        </div>
        
        <!-- åŠ è½½çŠ¶æ€ -->
        <div class="loading" id="loading">
            <div>æ­£åœ¨è·å–æ•°æ®...</div>
        </div>
        
        <!-- ä»ªè¡¨æ¿åŒºåŸŸ -->
        <div id="dashboard" style="display: none;">
            <!-- æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ -->
            <div class="dashboard-grid">
                <div class="metric-cards" id="metricCards">
                    <!-- æŒ‡æ ‡å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- å›¾è¡¨åŒºåŸŸ -->
            <div class="dashboard-grid">
                <div class="chart-container half">
                    <div class="chart-title">ğŸ“ˆ é¡¹ç›®ç»¼åˆè¯„åˆ†é›·è¾¾å›¾</div>
                    <div class="chart-placeholder">
                        é›·è¾¾å›¾å°†åœ¨è¿™é‡Œæ˜¾ç¤º
                    </div>
                </div>
                
                <div class="chart-container half">
                    <div class="chart-title">ğŸ“Š æ´»è·ƒåº¦è¶‹åŠ¿å›¾</div>
                    <div class="chart-placeholder">
                        è¶‹åŠ¿å›¾å°†åœ¨è¿™é‡Œæ˜¾ç¤º
                    </div>
                </div>
            </div>
            
            <!-- æ•°æ®è¡¨æ ¼ -->
            <div class="dashboard-grid">
                <div class="data-table">
                    <div class="table-header">
                        <div class="chart-title">ğŸ“‹ çƒ­é—¨ä»“åº“å¯¹æ¯”</div>
                    </div>
                    <div class="table-content">
                        <table id="comparisonTable">
                            <thead>
                                <tr>
                                    <th>ä»“åº“åç§°</th>
                                    <th>ä¸»è¦è¯­è¨€</th>
                                    <th>OpenRank</th>
                                    <th>æ´»è·ƒåº¦</th>
                                    <th>è´¡çŒ®è€…æ•°</th>
                                    <th>æäº¤é¢‘ç‡</th>
                                    <th>å“åº”æ—¶é—´(å¤©)</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                                <!-- è¡¨æ ¼æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>OpenDiggeræ•°æ®åˆ†æå¹³å° Â© 2024 | DataEaseå¯è§†åŒ–é¢„è§ˆç‰ˆ</p>
        <p>APIæœåŠ¡å™¨: http://localhost:5000 | æ•°æ®æº: OpenDigger API</p>
    </div>
    
    <script>
        // æ¨¡æ‹Ÿæ•°æ® - åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šä»APIè·å–
        const sampleData = {
            repo_name: "X-lab2018/open-digger",
            primary_language: "JavaScript",
            description: "Open source project analysis tools and platform",
            openrank: 45.2,
            activity_score: 8.5,
            contributor_count: 128,
            commit_frequency: 10.5,
            avg_response_time: 3.2
        };
        
        const sampleComparisonData = [
            {
                repo_name: "X-lab2018/open-digger",
                primary_language: "JavaScript",
                openrank: 45.2,
                activity_score: 8.5,
                contributor_count: 128,
                commit_frequency: 10.5,
                avg_response_time: 3.2
            },
            {
                repo_name: "vuejs/vue",
                primary_language: "JavaScript",
                openrank: 98.7,
                activity_score: 9.8,
                contributor_count: 342,
                commit_frequency: 25.3,
                avg_response_time: 1.2
            },
            {
                repo_name: "facebook/react",
                primary_language: "JavaScript",
                openrank: 96.5,
                activity_score: 9.5,
                contributor_count: 1563,
                commit_frequency: 32.8,
                avg_response_time: 2.4
            },
            {
                repo_name: "tensorflow/tensorflow",
                primary_language: "C++",
                openrank: 87.3,
                activity_score: 8.9,
                contributor_count: 2894,
                commit_frequency: 45.6,
                avg_response_time: 5.8
            }
        ];
        
        // æŒ‡æ ‡å¡ç‰‡é…ç½®
        const metricConfigs = [
            {
                field: 'openrank',
                name: 'OpenRankæŒ‡æ•°',
                icon: 'ğŸ“Š',
                color: '#4CAF50'
            },
            {
                field: 'activity_score',
                name: 'æ´»è·ƒåº¦åˆ†æ•°',
                icon: 'âš¡',
                color: '#2196F3'
            },
            {
                field: 'contributor_count',
                name: 'è´¡çŒ®è€…æ•°é‡',
                icon: 'ğŸ‘¥',
                color: '#FF9800'
            },
            {
                field: 'avg_response_time',
                name: 'å¹³å‡å“åº”å¤©æ•°',
                icon: 'â±ï¸',
                color: '#9C27B0'
            }
        ];
        
        // åˆ†æä»“åº“
        async function analyzeRepository() {
            const owner = document.getElementById('owner').value;
            const repo = document.getElementById('repo').value;
            
            if (!owner || !repo) {
                alert('è¯·è¾“å…¥ä»“åº“æ‰€æœ‰è€…å’Œä»“åº“åç§°');
                return;
            }
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('loading').classList.add('active');
            document.getElementById('dashboard').style.display = 'none';
            
            try {
                // åœ¨å®é™…ç¯å¢ƒä¸­ï¼Œè¿™é‡Œåº”è¯¥è°ƒç”¨çœŸå®çš„API
                // const response = await fetch('http://localhost:5000/analyze', {
                //     method: 'POST',
                //     headers: {'Content-Type': 'application/json'},
                //     body: JSON.stringify({ owner, repo })
                // });
                // const data = await response.json();
                
                // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
                const data = {
                    success: true,
                    data: {
                        ...sampleData,
                        repo_name: `${owner}/${repo}`
                    }
                };
                
                if (data.success) {
                    updateDashboard(data.data);
                    loadComparisonData();
                    document.getElementById('dashboard').style.display = 'block';
                } else {
                    alert('è·å–æ•°æ®å¤±è´¥: ' + (data.error || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                alert('è¯·æ±‚å¤±è´¥: ' + error.message);
                // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œæ˜¾ç¤ºæ¨¡æ‹Ÿæ•°æ®
                updateDashboard({
                    ...sampleData,
                    repo_name: `${owner}/${repo}`
                });
                loadComparisonData();
                document.getElementById('dashboard').style.display = 'block';
            } finally {
                document.getElementById('loading').classList.remove('active');
            }
        }
        
        // æ›´æ–°ä»ªè¡¨æ¿
        function updateDashboard(repoData) {
            updateMetricCards(repoData);
            updateTableTitle(repoData.repo_name);
        }
        
        // æ›´æ–°æŒ‡æ ‡å¡ç‰‡
        function updateMetricCards(data) {
            const container = document.getElementById('metricCards');
            container.innerHTML = '';
            
            metricConfigs.forEach(config => {
                const value = data[config.field];
                const formattedValue = formatValue(value, config.field);
                
                const card = document.createElement('div');
                card.className = 'metric-card';
                card.innerHTML = `
                    <div class="metric-icon">${config.icon}</div>
                    <div class="metric-content">
                        <div class="metric-name">${config.name}</div>
                        <div class="metric-value" style="color: ${config.color}">${formattedValue}</div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // æ›´æ–°è¡¨æ ¼æ ‡é¢˜
        function updateTableTitle(repoName) {
            const tableHeader = document.querySelector('.table-header .chart-title');
            if (tableHeader) {
                tableHeader.textContent = `ğŸ“‹ ${repoName} ä¸çƒ­é—¨ä»“åº“å¯¹æ¯”`;
            }
        }
        
        // åŠ è½½å¯¹æ¯”æ•°æ®
        function loadComparisonData() {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            sampleComparisonData.forEach(repo => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${repo.repo_name}</td>
                    <td>${repo.primary_language}</td>
                    <td>${formatValue(repo.openrank, 'openrank')}</td>
                    <td>${formatValue(repo.activity_score, 'activity_score')}</td>
                    <td>${formatValue(repo.contributor_count, 'contributor_count')}</td>
                    <td>${formatValue(repo.commit_frequency, 'commit_frequency')}</td>
                    <td>${formatValue(repo.avg_response_time, 'avg_response_time')}</td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // æ ¼å¼åŒ–æ•°å€¼
        function formatValue(value, field) {
            if (value === undefined || value === null) return '-';
            
            switch(field) {
                case 'openrank':
                case 'activity_score':
                    return value.toFixed(2);
                case 'contributor_count':
                    return value.toLocaleString();
                case 'commit_frequency':
                case 'avg_response_time':
                    return value.toFixed(1);
                default:
                    return value;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºé»˜è®¤æ•°æ®
        window.addEventListener('DOMContentLoaded', () => {
            document.getElementById('owner').value = 'X-lab2018';
            document.getElementById('repo').value = 'open-digger';
            
            // æ˜¾ç¤ºæ¨¡æ‹Ÿæ•°æ®
            updateDashboard(sampleData);
            loadComparisonData();
            document.getElementById('dashboard').style.display = 'block';
        });
    </script>
</body>
</html>